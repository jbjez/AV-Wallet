<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="AV Wallet">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="AV Wallet">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">
  <link rel="icon" type="image/png" href="assets/logo_web.png"/>
  <title>AV Wallet</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: url('assets/background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
      min-height: 100vh;
      position: relative;
    }

    .overlay {
      background-color: rgba(10, 17, 40, 0.85);
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 0;
      min-height: 100vh;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: auto;
      padding: 60px 20px;
      text-align: center;
      min-height: 100vh;
    }

    .language-menu {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 2;
    }

    .language-select {
      background-color: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid white;
      border-radius: 8px;
      padding: 6px;
      font-size: 14px;
    }

    .logo {
      max-width: 140px;
      margin: 0 auto 0;
    }

    h1 {
      font-size: 40px;
      font-weight: 800;
      margin-bottom: 10px;
    }

    p.subtitle {
      font-size: 20px;
      color: #93AEDD;
      margin-bottom: 40px;
    }

    footer {
      text-align: center;
      margin-top: 60px;
      font-size: 13px;
      color: #ccc;
    }

    .page-flex {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 40px;
      flex-wrap: wrap;
      min-height: 60vh;
    }
    @media (max-width: 900px) {
      .page-flex {
        flex-direction: column;
        gap: 0;
      }
      .main-block, .screenshot-block, .video-block {
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
      }
      .main-block { order: 1; }
      .screenshot-block { order: 2; }
      .video-block { order: 3; }
    }
  </style>
</head>
<body>
  <div class="overlay"></div>

  <!-- Barre de navigation en haut à droite -->
  <nav style="position: absolute; top: 20px; right: 30px; z-index: 10; display: flex; gap: 24px;">
    <a id="tutorials-link" href="#" style="color: #fff; text-decoration: none; font-weight: bold; font-size: 16px;">Tutoriels</a>
    <a id="account-link" href="#" style="color: #fff; text-decoration: none; font-weight: bold; font-size: 16px;">Login</a>
    <a id="privacy-link" href="privacy_fr.html" style="color: #fff; text-decoration: none; font-weight: bold; font-size: 16px;">Privacy</a>
  </nav>

  <div class="language-menu">
    <div class="custom-select" onclick="toggleDropdown()">
      <img id="current-flag" src="assets/flag_fr_48.png" alt="Langue" style="width:24px;height:24px;border-radius:50%;cursor:pointer;border:2px solid white;object-fit:cover;">
      <div id="dropdown-lang" style="display:none;position:absolute;top:32px;left:0;background:#1c1c1c;border:1px solid white;border-radius:8px;padding:6px 0;z-index:10;">
        <img src="assets/flag_fr_48.png" alt="Français" style="width:24px;height:24px;margin:4px;cursor:pointer;border-radius:50%;object-fit:cover;" onclick="setLanguage('fr')">
        <img src="assets/flag_en_48.png" alt="English" style="width:24px;height:24px;margin:4px;cursor:pointer;border-radius:50%;object-fit:cover;" onclick="setLanguage('en')">
        <img src="assets/flag_de_48.png" alt="Deutsch" style="width:24px;height:24px;margin:4px;cursor:pointer;border-radius:50%;object-fit:cover;" onclick="setLanguage('de')">
        <img src="assets/flag_it_48.png" alt="Italiano" style="width:24px;height:24px;margin:4px;cursor:pointer;border-radius:50%;object-fit:cover;" onclick="setLanguage('it')">
        <img src="assets/flag_es_48.png" alt="Español" style="width:24px;height:24px;margin:4px;cursor:pointer;border-radius:50%;object-fit:cover;" onclick="setLanguage('es')">
      </div>
    </div>
  </div>

  <div class="container">
    <div class="page-flex">
      <div class="screenshot-block" style="background: transparent; display: flex; justify-content: center; align-items: center; min-width: 220px;">
        <img src="assets/screenshot_catalogue.jpg" alt="Capture d'écran AV Wallet" style="max-width: 220px; width: 100%; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.15);">
      </div>
      <div class="main-block" style="background: transparent; flex: 2; min-width: 300px; max-width: 420px; display: flex; flex-direction: column; align-items: center;">
        <!-- Logo centré sans cadre -->
        <img src="assets/logo_web.png" alt="Logo AV Wallet" class="logo" style="display: block; margin: 0 auto 0 auto; max-width: 140px;">
        <h1>AV Wallet</h1>
        <p class="subtitle">Votre expertise dans la poche.</p>
        <p id="context-text" style="max-width: 1000px; margin: 0 auto 30px auto; text-align: center; font-size: 12px; color: #eee;">
          Que vous soyez en plein montage, en préparation ou en repérage client, AV Wallet vous donne les bons chiffres, les bons outils, au bon moment.<br>
          Fini les approximations. Gagnez en rigueur, en temps et en crédibilité.
        </p>
        <!-- Boutons de téléchargement -->
        <div style="display: flex; justify-content: center; gap: 40px; margin: 70px 0 40px 0;">
          <a href="#" style="display: flex; flex-direction: column; align-items: center; justify-content: center; width: 150px; height: 150px; background: #fff; border: 2px solid #000; border-radius: 20px; text-decoration: none; color: #000; transition: background 0.3s, transform 0.3s; font-weight: bold; font-size: 18px;">
            <img src="assets/logo_apple.jpeg" alt="Apple" style="width: 56px;px; height:56px; margin-bottom: 12px; object-fit: contain;">
            iOS
          </a>
          <a href="#" style="display: flex; flex-direction: column; align-items: center; justify-content: center; width: 150px; height: 150px; background: #fff; border: 2px solid #3ddc84; border-radius: 20px; text-decoration: none; color: #3ddc84; transition: background 0.3s, transform 0.3s; font-weight: bold; font-size: 18px;">
            <img src="assets/logo_android.jpeg" alt="Android" style="width:56px; height:56px; margin-bottom: 12px; object-fit: contain;">
          </a>
        </div>
      </div>
      <div class="video-block" style="background: transparent; display: flex; justify-content: center; align-items: center; min-width: 220px;">
        <img src="assets/screenshot_home.jpg" alt="Capture d'écran AV Wallet" style="max-width: 220px; width: 100%; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.15);">
      </div>
    </div>
    <footer>© 2025 AV Wallet — Tous droits réservés</footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  function toggleDropdown() {
    const menu = document.getElementById('dropdown-lang');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
  }

  function setLanguage(lang) {
    localStorage.setItem('lang', lang);
    updateLanguage(lang);
    document.getElementById('dropdown-lang').style.display = 'none';
  }

  function updateLanguage(lang) {
    const t = translations[lang] || translations['fr'];
    document.querySelector('.subtitle').textContent = t.slogan;
    document.getElementById('context-text').innerHTML = t.context;
    document.querySelector('footer').textContent = t.footer;
    document.getElementById('current-flag').src = `assets/flag_${lang}_48.png`;
    document.getElementById('tutorials-link').textContent = t.tutorials;
    document.getElementById('account-link').textContent = t.account;
  }

  window.addEventListener('DOMContentLoaded', () => {
    const lang = localStorage.getItem('lang') || 'fr';
    updateLanguage(lang);
    // Lien privacy dynamique
    const privacyMap = {
      fr: 'privacy_fr.html',
      en: 'privacy_en.html',
      de: 'privacy_de.html',
      it: 'privacy_it.html',
      es: 'privacy_es.html'
    };
    document.getElementById('privacy-link').href = privacyMap[lang] || 'privacy_fr.html';
  });
</script>
  <script>
    function setLanguage(lang) {
      localStorage.setItem('lang', lang);
      location.reload();
    }

    window.addEventListener('load', function() {
      const errorCode = new URLSearchParams(window.location.search).get('error');
      const errorDescription = new URLSearchParams(window.location.search).get('error_description');
      if (errorCode) {
        console.error('OAuth Error:', errorCode, errorDescription);
        window.opener?.postMessage({ type: 'oauth_error', error: errorCode, description: errorDescription }, '*');
        window.close();
        return;
      }

      const authCode = new URLSearchParams(window.location.search).get('code');
      if (authCode) {
        console.log('Auth code received, sending to parent');
        window.opener?.postMessage({ type: 'oauth_success', code: authCode }, '*');
        window.close();
      }
    });
  </script>

  <script>
    const serviceWorkerVersion = null;
  </script>
  <script src="flutter.js" defer></script>
  <div id="loading">Chargement...</div>
  <script>
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.error);
      document.getElementById('loading').textContent = 'Erreur : ' + e.error;
    });

    window.addEventListener('load', function(ev) {
      console.log('Window loaded, initializing Flutter...');
      var loading = document.getElementById('loading');
      _flutter.loader.loadEntrypoint({
        serviceWorker: { serviceWorkerVersion: serviceWorkerVersion },
        onEntrypointLoaded: function(engineInitializer) {
          engineInitializer.initializeEngine().then(function(appRunner) {
            appRunner.runApp();
          });
        }
      });
    });
  </script>
  <script>
    const translations = {
      fr: {
        slogan: "Votre expertise dans la poche.",
        context: "Que vous soyez en plein montage, en préparation ou en repérage client, AV Wallet vous donne les bons chiffres, les bons outils, au bon moment.<br>Fini les approximations. Gagnez en rigueur, en temps et en crédibilité.",
        footer: "© 2025 AV Wallet — Tous droits réservés",
        download: "Télécharger l'application",
        account: "Login",
        tutorials: "Tutoriels"
      },
      en: {
        slogan: "Your expertise, in your pocket.",
        context: "Whether you are in the middle of setup, preparing, or on a client visit, AV Wallet gives you the right numbers, the right tools, at the right time.<br>No more guesswork. Gain accuracy, save time, and boost your credibility.",
        footer: "© 2025 AV Wallet — All rights reserved",
        download: "Download the app",
        account: "Login",
        tutorials: "Tutorials"
      },
      de: {
        slogan: "Ihre Expertise in der Tasche.",
        context: "Ob Sie gerade aufbauen, vorbereiten oder beim Kunden sind – AV Wallet liefert Ihnen die richtigen Zahlen, die richtigen Tools, zum richtigen Zeitpunkt.<br>Schluss mit Schätzungen. Gewinnen Sie an Präzision, sparen Sie Zeit und steigern Sie Ihre Glaubwürdigkeit.",
        footer: "© 2025 AV Wallet — Alle Rechte vorbehalten",
        download: "App herunterladen",
        account: "Login",
        tutorials: "Tutorials"
      },
      it: {
        slogan: "La tua competenza, sempre con te.",
        context: "Che tu sia in fase di montaggio, preparazione o sopralluogo dal cliente, AV Wallet ti offre i numeri giusti, gli strumenti giusti, al momento giusto.<br>Basta approssimazioni. Guadagna in precisione, tempo e credibilità.",
        footer: "© 2025 AV Wallet — Tutti i diritti riservati",
        download: "Scarica l'app",
        account: "Login",
        tutorials: "Tutoriali"
      },
      es: {
        slogan: "Tu experiencia en el bolsillo.",
        context: "Ya sea durante el montaje, la preparación o una visita al cliente, AV Wallet te da los datos correctos, las herramientas adecuadas, en el momento justo.<br>Se acabaron las aproximaciones. Gana rigor, tiempo y credibilidad.",
        footer: "© 2025 AV Wallet — Todos los derechos reservados",
        download: "Descargar la app",
        account: "Login",
        tutorials: "Tutoriales"
      }
    };

    window.addEventListener('DOMContentLoaded', () => {
      const lang = localStorage.getItem('lang') || 'fr';
      updateLanguage(lang);
    });
  </script>
</body>
</html>
