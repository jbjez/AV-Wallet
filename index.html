<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="AV Wallet">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="AV Wallet">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">
  <link rel="icon" type="image/png" href="favicon.png"/>
  <title>AV Wallet</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: url('assets/background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
    }

    .overlay {
      background-color: rgba(10, 17, 40, 0.85);
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 0;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: auto;
      padding: 60px 20px;
      text-align: center;
    }

    .language-menu {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 2;
    }

    .language-select {
      background-color: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid white;
      border-radius: 8px;
      padding: 6px;
      font-size: 14px;
    }

    .logo {
      max-width: 200px;
      margin: 0 auto 20px;
    }

    h1 {
      font-size: 40px;
      font-weight: 800;
      margin-bottom: 10px;
    }

    p.subtitle {
      font-size: 20px;
      color: #93AEDD;
      margin-bottom: 40px;
    }

    footer {
      text-align: center;
      margin-top: 60px;
      font-size: 13px;
      color: #ccc;
    }
  </style>
</head>
<body>
  <div class="overlay"></div>

  <!-- Barre de navigation en haut à droite -->
  <nav style="position: absolute; top: 20px; right: 30px; z-index: 10; display: flex; gap: 24px;">
    <a href="#" style="color: #fff; text-decoration: none; font-weight: bold; font-size: 16px;">Tutoriels</a>
    <a href="#" style="color: #fff; text-decoration: none; font-weight: bold; font-size: 16px;">Mon compte</a>
    <a href="privacy.html" style="color: #fff; text-decoration: none; font-weight: bold; font-size: 16px;">Privacy</a>
  </nav>

  <div class="language-menu">
    <div class="custom-select" onclick="toggleDropdown()">
      <img id="current-flag" src="assets/flag_fr_48.png" alt="Langue" style="width:32px;height:32px;border-radius:50%;cursor:pointer;border:2px solid white;">
      <div id="dropdown-lang" style="display:none;position:absolute;top:40px;left:0;background:#1c1c1c;border:1px solid white;border-radius:8px;padding:6px 0;z-index:10;">
        <img src="assets/flag_fr_48.png" alt="Français" style="width:32px;height:32px;margin:5px;cursor:pointer;" onclick="setLanguage('fr')">
        <img src="assets/flag_en_48.png" alt="English" style="width:32px;height:32px;margin:5px;cursor:pointer;" onclick="setLanguage('en')">
        <img src="assets/flag_de_48.png" alt="Deutsch" style="width:32px;height:32px;margin:5px;cursor:pointer;" onclick="setLanguage('de')">
        <img src="assets/flag_it_48.png" alt="Italiano" style="width:32px;height:32px;margin:5px;cursor:pointer;" onclick="setLanguage('it')">
        <img src="assets/flag_es_48.png" alt="Español" style="width:32px;height:32px;margin:5px;cursor:pointer;" onclick="setLanguage('es')">
      </div>
    </div>
  </div>

  <div class="container">
    <div style="display: flex; justify-content: center; align-items: center; gap: 40px; flex-wrap: wrap; min-height: 60vh;">
      <!-- Screenshot à gauche -->
      <div style="flex: 1; display: flex; justify-content: center; align-items: center; min-width: 220px;">
        <img src="assets/screenshot.PNG" alt="Capture d'écran AV Wallet" style="max-width: 220px; width: 100%; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.15);">
      </div>
      <!-- Contenu principal (logo + boutons) -->
      <div style="flex: 2; min-width: 300px; max-width: 420px; display: flex; flex-direction: column; align-items: center;">
        <!-- Logo encadré -->
        <div style="background: rgba(120,120,120,0.95); border: 3px solid #fff; border-radius: 24px; display: inline-block; padding: 18px 24px 8px 24px; margin-bottom: 20px; margin-top: 10px;">
          <img src="assets/logo.png" alt="Logo AV Wallet" class="logo" style="display: block; margin: 0 auto; max-width: 100px;">
        </div>
        <h1>AV Wallet</h1>
        <p class="subtitle">Votre expertise dans la poche.</p>
        <!-- Boutons de téléchargement -->
        <div style="display: flex; justify-content: center; gap: 40px; margin: 40px 0;">
          <a href="#" style="display: flex; flex-direction: column; align-items: center; justify-content: center; width: 150px; height: 150px; background: #000; border: 2px solid #fff; border-radius: 20px; text-decoration: none; color: #fff; transition: background 0.3s, transform 0.3s; font-weight: bold; font-size: 18px;">
            <img src="assets/apple_logo.png" alt="Apple" style="width:40px; height:40px; margin-bottom: 8px;">
            <i class="fab fa-apple" style="font-size: 40px; margin-bottom: 8px; color: #fff;"></i>
            iOS
          </a>
          <a href="#" style="display: flex; flex-direction: column; align-items: center; justify-content: center; width: 150px; height: 150px; background: #3ddc84; border: 2px solid #fff; border-radius: 20px; text-decoration: none; color: #fff; transition: background 0.3s, transform 0.3s; font-weight: bold; font-size: 18px;">
            <img src="assets/google_play.png" alt="Google Play" style="width:40px; height:40px; margin-bottom: 8px;">
            <i class="fab fa-android" style="font-size: 40px; margin-bottom: 8px; color: #fff;"></i>
            Android
          </a>
        </div>
      </div>
      <!-- Vidéo à droite -->
      <div style="flex: 1; display: flex; justify-content: center; align-items: center; min-width: 220px;">
        <video src="assets/movieshot.mov" controls loop style="width: 220px; height: 440px; max-width: 220px; max-height: 440px; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.15); object-fit: contain; background: #222;"></video>
      </div>
    </div>
    <footer>© 2025 AV Wallet — Tous droits réservés</footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  function toggleDropdown() {
    const menu = document.getElementById('dropdown-lang');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
  }

  function setLanguage(lang) {
    localStorage.setItem('lang', lang);
    document.getElementById('current-flag').src = `assets/flag_${lang}_48.png`;
    document.getElementById('dropdown-lang').style.display = 'none';
    location.reload();
  }
</script>
  <script>
    function setLanguage(lang) {
      localStorage.setItem('lang', lang);
      location.reload();
    }

    window.addEventListener('load', function() {
      const errorCode = new URLSearchParams(window.location.search).get('error');
      const errorDescription = new URLSearchParams(window.location.search).get('error_description');
      if (errorCode) {
        console.error('OAuth Error:', errorCode, errorDescription);
        window.opener?.postMessage({ type: 'oauth_error', error: errorCode, description: errorDescription }, '*');
        window.close();
        return;
      }

      const authCode = new URLSearchParams(window.location.search).get('code');
      if (authCode) {
        console.log('Auth code received, sending to parent');
        window.opener?.postMessage({ type: 'oauth_success', code: authCode }, '*');
        window.close();
      }
    });
  </script>

  <script>
    const serviceWorkerVersion = null;
  </script>
  <script src="flutter.js" defer></script>
  <div id="loading">Chargement...</div>
  <script>
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.error);
      document.getElementById('loading').textContent = 'Erreur : ' + e.error;
    });

    window.addEventListener('load', function(ev) {
      console.log('Window loaded, initializing Flutter...');
      var loading = document.getElementById('loading');
      _flutter.loader.loadEntrypoint({
        serviceWorker: { serviceWorkerVersion: serviceWorkerVersion },
        onEntrypointLoaded: function(engineInitializer) {
          engineInitializer.initializeEngine().then(function(appRunner) {
            appRunner.runApp();
          });
        }
      });
    });
  </script>
  <script>
    const lang = localStorage.getItem('lang') || 'fr';
    const translations = {
      fr: {
        slogan: "Votre expertise dans la poche.",
        footer: "© 2025 AV Wallet — Tous droits réservés",
        download: "Télécharger l'application",
        account: "Mon compte"
      },
      en: {
        slogan: "Your expertise, in your pocket.",
        footer: "© 2025 AV Wallet — All rights reserved",
        download: "Download the app",
        account: "My account"
      },
      de: {
        slogan: "Ihre Expertise in der Tasche.",
        footer: "© 2025 AV Wallet — Alle Rechte vorbehalten",
        download: "App herunterladen",
        account: "Mein Konto"
      },
      it: {
        slogan: "La tua competenza, sempre con te.",
        footer: "© 2025 AV Wallet — Tutti i diritti riservati",
        download: "Scarica l'app",
        account: "Il mio account"
      },
      es: {
        slogan: "Tu experiencia en el bolsillo.",
        footer: "© 2025 AV Wallet — Todos los derechos reservados",
        download: "Descargar la app",
        account: "Mi cuenta"
      }
    };

    window.addEventListener('DOMContentLoaded', () => {
      const t = translations[lang] || translations['fr'];
      document.querySelector('.subtitle').textContent = t.slogan;
      document.querySelector('footer').textContent = t.footer;
      document.getElementById('downloadBtn').textContent = t.download;
      document.getElementById('accountBtn').textContent = t.account;
    });
  </script>
</body>
</html>
